<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>SHAKOM PS - Cache</title>
    <script src="./bundle.js"></script>
    <style>
      html,body{height:100%;margin:0}
      body {
        background: url('./imgg.jpg');
        background-size: cover;
        background-color: #252526;
        font-family: sans-serif;
      }
      h2 { margin-bottom: 20px; color: #ffffff; text-align: center; padding-top: 20px; }
      #console { font-family: monospace; background-color: rgba(30,30,30,0.85); color: #cccccc; border: 1px solid #3c3c3c; padding: 12px; border-radius: 6px; margin: 20px auto; text-align: left; max-width: 900px; white-space: pre-wrap; }
      #jailbreakBtn { display: none; }
      footer { margin-top: 30px; font-size: 14px; color: #888; text-align: center; }
      a { color: #aaa; }
      .wrap { max-width: 960px; margin: 0 auto; padding: 16px; }
    </style>
  </head>
  <body>
    <div class="wrap">
      <h2>SHAKOM PS (Cache)</h2>
      <div>
        <button id="jailbreakBtn">اضغط هنا لتفعيل التعديل</button>
      </div>
      <pre id="console"></pre>
      <footer>
        <p>You are viewing the cached page.</p>
        <p><a href="/index.html">Return to live page</a></p>
      </footer>
    </div>

  <script>
    // Clear history and prevent back navigation
    history.replaceState(null, null, 'index.html');
    var histlength = history.length;
    history.go(-histlength);
    // Logging utility
    const outputConsole = document.getElementById("console");
    window.log = (msg) => { outputConsole.textContent += msg + "\n"; };
    // Download progress (% display)
    function DLProgress(e) {
      const percent = (Math.round((e.loaded / e.total) * 100));
      window.log(`[CACHE] Downloading... ${percent}% complete.`);
    }
    // On cache complete
    function DisplayCacheProgress() {
      window.log(" ");
      window.log("[SUCCESS] Cache installed successfully.");
      window.log("Page will reload in 3 seconds...");
      // Delay to show success message before navigation
      setTimeout(function() { window.log("Reloading..."); }, 2000);
      // Navigate back to index.html to load the exploit from cache
      setTimeout(function() { location.reload(); }, 3000);
    }
    // Event listeners
    window.applicationCache.addEventListener("progress", DLProgress, false);
    window.applicationCache.oncached = function(e) { DisplayCacheProgress(); };
    window.applicationCache.onupdateready = function(e) { DisplayCacheProgress(); };
    // Initialization message on DOM load
    document.addEventListener('DOMContentLoaded', () => {
      outputConsole.textContent = ""; // Clear console log
      window.log("AppCache download initiating...");
      window.log("Please wait, this may take a few seconds.");
    });
  </script>
</body>
</html>
